robotpkg package names may have a ~options suffix.

--- pkg_str.c~	2026-02-10 09:28:26.000000000 +0100
+++ pkg_str.c	2026-02-10 14:08:05.032982944 +0100
@@ -29,7 +29,7 @@
 
 #include "pkgin.h"
 
-#define GLOBCHARS "{<>[]?*"
+#define GLOBCHARS "{<>[]?*~"
 
 /*
  * Return best candidate for a remote package, taking into consideration any
@@ -111,8 +111,8 @@
 		if (best_match == NULL)
 			best_match = current;
 		else
-			if (dewey_cmp(current->version, DEWEY_GT,
-					best_match->version))
+			if (pkg_order("*", current->full,
+                                best_match->full) == 1)
 				best_match = current;
 	}
 
@@ -217,37 +217,32 @@
 int
 exact_pkgfmt(const char *pkgname)
 {
-	char	*p;
+	char	*p, *tmp;
+	int n;
 
-	if ((p = strrchr(pkgname, '-')) == NULL)
+	tmp = xstrdup(pkgname);
+	trunc_str(tmp, '~', STR_BACKWARD);
+
+	if ((p = strrchr(tmp, '-')) == NULL) {
+		free(tmp);
 		return 0;
+	}
 
 	p++;
 
 	/* naive assumption, will fail with foo-100bar, hopefully, there's
 	 * only a few packages needing to be fully specified
 	 */
-	return isdigit((int)*p);
+	n = isdigit((int)*p);
+	free(tmp);
+	return n;
 }
 
 /* similar to opattern.c's pkg_order but without pattern */
 int
 version_check(char *first_pkg, char *second_pkg)
 {
-	char *first_ver, *second_ver;
-
-	first_ver = strrchr(first_pkg, '-');
-	second_ver = strrchr(second_pkg, '-');
-
-	if (first_ver == NULL)
-		return 2;
-	if (second_ver == NULL)
-		return 1;
-
-	if (dewey_cmp(first_ver + 1, DEWEY_GT, second_ver + 1))
-		return 1;
-	else
-		return 2;
+	return pkg_order("*", first_pkg, second_pkg);
 }
 
 /*
